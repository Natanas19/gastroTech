<!DOCTYPE html> <!-- Declara que este documento é HTML5 -->
<html lang="pt-BR"> <!-- Elemento raiz; lang indica que o conteúdo está em português do Brasil -->
<head> <!-- Cabeçalho do documento: metadados, título e estilos -->
<meta charset="UTF-8" /> <!-- Define codificação de caracteres para UTF-8 -->
<meta name="viewport" content="width=device-width, initial-scale=1.0"/> <!-- Meta para responsividade em dispositivos móveis -->
<title>GastroTech</title> <!-- Título da aba do navegador -->

<style>
/* ============================================================
   ======== ESTILOS (CSS) =====================================
   ============================================================ */

/* Reset / padrão: remover margens e paddings e usar box-sizing border-box */
* {
  margin: 0; /* remove margem padrão */
  padding: 0; /* remove padding padrão */
  box-sizing: border-box; /* faz o width incluir padding e border */
  font-family: 'Poppins', sans-serif; /* define fonte padrão */
}

/* Estilo do body - cor de fundo, centralização e espaçamento */
body {
  background-color: rgb(34, 9, 1); /* fundo escuro marrom/pret */
  color: #fff; /* cor do texto padrão branca */
  display: flex; /* usa flexbox para centralizar vertical/horizontalmente */
  flex-direction: column; /* layout em coluna */
  align-items: center; /* centraliza horizontalmente */
  justify-content: center; /* centraliza verticalmente */
  min-height: 100vh; /* garante altura mínima da tela inteira */
  text-align: center; /* alinha texto ao centro */
  padding-top: 50px; /* espaço superior para não encostar no topo */
}

/* Estilo dos títulos h1, h2, h3: cor dourada e efeito de brilho */
h1, h2, h3 {
  color: #d4af37; /* cor dourada */
  text-shadow: 0 0 15px rgba(212, 175, 55, 0.5); /* sombra brilhante */
  animation: brilho 3s infinite ease-in-out; /* animação de brilho contínuo */
}

/* Estilização específica do h1: tamanho grande e espaçamento entre letras */
h1 {
  font-size: 60px; /* tamanho da fonte principal */
  margin-bottom: 40px; /* espaçamento abaixo do título */
  letter-spacing: 2px; /* espaço entre letras */
}

/* Contêiner padrão usado para todas as "telas" da SPA */
.container {
  position: relative; /* posição relativa para posicionamentos internos absolutos */
  width: 1106px; /* largura fixa principal (desktop) */
  min-height: 510px; /* altura mínima do container */
  margin: 0 auto 40px; /* centraliza horizontalmente e margem inferior */
  background-color: rgba(0,0,0,0.7); /* fundo semi-transparente preto */
  border: 2px solid #d4af37; /* borda dourada */
  border-radius: 15px; /* cantos arredondados */
  box-shadow: 0 0 25px rgba(212, 175, 55, 0.4); /* sombra dourada suave */
  display: none; /* inicialmente escondido — a SPA controla qual aparece */
  flex-direction: column; /* conteúdo em coluna */
  align-items: center; /* centraliza conteúdo */
  justify-content: center; /* centraliza verticalmente */
  padding: 30px; /* espaçamento interno */
}

/* Estilos base para botões, selects e inputs */
button, select, input {
  background-color: rgb(212, 175, 55); /* fundo dourado */
  color: #000; /* texto preto para contraste */
  border: none; /* remove borda padrão */
  padding: 12px 25px; /* espaçamento interno */
  margin: 10px; /* margem entre elementos */
  border-radius: 8px; /* cantos arredondados */
  font-size: 16px; /* tamanho da fonte */
  font-weight: bold; /* fonte em negrito */
  cursor: pointer; /* cursor "mão" ao passar */
  transition: .3s; /* transição suave para efeitos hover */
  box-shadow: 0 0 10px rgba(212, 175, 55, 0.3); /* brilho suave */
}

/* Efeito hover para botões e selects */
button:hover, select:hover {
  background-color: #fff; /* fundo branco ao passar o mouse */
  box-shadow: 0 0 20px #d4af37; /* maior brilho dourado */
  transform: translateY(-2px); /* leve elevação */
}

/* Ajuste para inputs: largura e padding interno */
input {
  width: 80%; /* largura relativa para inputs */
  padding: 10px; /* espaçamento interno */
  text-align: center; /* texto centralizado no input */
}

/* ============================================================
   ================ MAPA DE MESAS RESPONSIVO ==================
   ============================================================ */

/* Área do mapa (imagem de fundo representando o salão) */
#mapaMesas, #mapaMesasEdicao {
  position: relative; /* para posicionamento absoluto das mesas */
  width: 100%; /* ocupa 100% do container */
  background-image: url('mesas.jpg'); /* imagem de fundo (coloque mesas.jpg na pasta) */
  background-size: cover; /* cobre todo o espaço */
  background-position: center; /* centraliza a imagem */
  background-repeat: no-repeat; /* evita repetição */
  border-radius: 10px; /* cantos arredondados */
  margin-top: 20px; /* margem superior */
  aspect-ratio: 1106 / 510; /* mantém proporção similar ao layout */
}

/* Dentro do mapa, cada .mesa será posicionada de forma absoluta */
#mapaMesas .mesa, #mapaMesasEdicao .mesa {
  position: absolute; /* posições definidas via left/top em % */
}

/* Estilo base de cada mesa (círculo verde para disponível) */
.mesa {
  width: 6%; /* largura relativa, torna responsiva */
  aspect-ratio: 1/1; /* mantém formato quadrado (torna circular com border-radius) */
  border-radius: 50%; /* formato circular */
  background-color: rgb(12, 92, 12); /* verde escuro para disponível */
  border: 2px solid rgba(255,255,255,0.3); /* borda sutil */
  color: white; /* texto dentro da mesa (número) em branco */
  font-weight: bold; /* número em negrito */
  font-size: 16px; /* tamanho do número */
  cursor: pointer; /* cursor de ponteiro ao passar */
  opacity: 0.9; /* leve transparência */
  transition: .3s; /* transições suaves */
  box-shadow: 0 0 12px rgba(0,255,0,0.3); /* brilho verde */
}

/* Efeito hover na mesa: aumenta e intensifica o brilho */
.mesa:hover {
  transform: scale(1.15); /* aumenta levemente */
  box-shadow: 0 0 20px rgba(0,255,0,0.6); /* brilho mais forte */
}

/* Estilo quando mesa está ocupada (vermelho) */
.mesa.ocupada {
  background-color: #a80000; /* vermelho para ocupada */
  box-shadow: 0 0 20px rgba(255,0,0,0.6); /* brilho vermelho */
}

/* Espaçamento superior do botão reservar */
#btnReservar {
  margin-top: 20px;
}

/* Animação do brilho usada nos títulos */
@keyframes brilho {
  0% { text-shadow: 0 0 10px rgba(34, 9, 1); }
  50% { text-shadow: 0 0 20px rgb(246, 170, 28); }
  100% { text-shadow: 0 0 10px rgba(34, 9, 1); }
}

/* Ajustes responsivos para telas menores */
@media (max-width: 1200px) {
  .container { width: 94%; } /* container mais estreito */
  h1 { font-size: 45px; } /* reduz tamanho do título */
  .mesa { font-size: 13px; } /* reduz o nº dentro das mesas */
}
</style>
</head>

<body>

<!-- ============================================================
     ===================== TELAS (HTML) =========================
     ============================================================ -->

<!-- Tela Inicial: mostra o título e botões principais -->
<div id="inicio" class="container" style="display:flex;">
    <!-- Exibe o título (logo do sistema) -->
    <h1>GastroTech</h1>

    <!-- Botão para ir para a tela de mapa/reserva -->
    <button onclick="irPara('mapa')">Reservar</button>

    <!-- Botão para ir à tela de consulta de reserva do cliente -->
    <button onclick="irPara('loginConsulta')">Consultar Reserva</button>

    <!-- Botão novo: abre a tela de login do administrador -->
    <button onclick="irPara('adminLogin')">Admin</button>
</div>

<!-- Tela de login do Admin: pede usuário e senha -->
<div id="adminLogin" class="container">
    <h2>Área Administrativa</h2>

    <input type="text" id="admUser" placeholder="Usuário"><br> <!-- input usuário admin -->
    <input type="password" id="admPass" placeholder="Senha"><br> <!-- input senha admin -->

    <button onclick="loginAdmin()">Entrar</button> <!-- chama função que valida credenciais -->
    <button onclick="irPara('inicio')">Voltar</button> <!-- botão para retornar à tela inicial -->
</div>

<!-- Painel Admin: permite selecionar horário e listar reservas -->
<div id="adminPainel" class="container">
    <h2>Reservas por Horário</h2>

    <!-- Dropdown de horários para o admin escolher -->
    <select id="adminHorarios" onchange="listarReservasHorario()">
        <option value="" disabled selected>Selecione um horário</option>
        <option>10h às 11h</option>
        <option>11h às 12h</option>
        <option>12h às 13h</option>
        <option>13h às 14h</option>
        <option>14h às 15h</option>
    </select>

    <!-- Local onde a lista de reservas do horário selecionado será injetada -->
    <div id="listaAdmin" style="margin-top:20px; font-size:18px;"></div>

    <!-- Botão para voltar ao início -->
    <button onclick="irPara('inicio')">Voltar ao Início</button>
</div>

<!-- Tela Mapa: seleção de horário e visualização das mesas -->
<div id="mapa" class="container">
    <h2>Escolha o horário</h2>

    <!-- Dropdown de horários para o cliente escolher -->
    <select id="horario" onchange="mostrarMesas()">
        <option>10h às 11h</option>
        <option>11h às 12h</option>
        <option>12h às 13h</option>
        <option>13h às 14h</option>
        <option>14h às 15h</option>
    </select>

    <!-- Aqui as divs .mesa serão criadas dinamicamente por JavaScript -->
    <div id="mapaMesas"></div>

    <!-- Botão que aparece quando o usuário seleciona uma mesa -->
    <button id="btnReservar" style="display:none;" onclick="irPara('cadastro')">Reservar</button>
    <button onclick="irPara('inicio')">Voltar</button>
</div>

<!-- Tela de Cadastro: formulário para finalizar a reserva -->
<div id="cadastro" class="container">
    <h2>Cadastro</h2>
    <input type="text" id="nome" placeholder="Nome"><br> <!-- nome do cliente -->
    <input type="email" id="email" placeholder="Email"><br> <!-- email do cliente -->
    <input type="password" id="senha" placeholder="Senha"><br> <!-- senha simples para consultar depois -->
    <button onclick="finalizarReserva()">Finalizar Reserva</button> <!-- finaliza e salva -->
</div>

<!-- Tela de agradecimento: mostra detalhes da reserva -->
<div id="agradecimento" class="container">
    <h2>Reserva Confirmada!</h2>
    <p id="msgAgradecimento"></p> <!-- mensagem com nome, mesa, horário e código -->
    <button onclick="irPara('inicio')">Voltar ao Início</button>
</div>

<!-- Tela de login para consulta de reservas por cliente -->
<div id="loginConsulta" class="container">
    <h2>Consultar Reserva</h2>
    <input type="email" id="emailLogin" placeholder="Email"><br> <!-- email usado na reserva -->
    <input type="password" id="senhaLogin" placeholder="Senha"><br> <!-- senha para autenticar consulta -->
    <button onclick="consultarReserva()">Consultar</button> <!-- procura a reserva -->
    <button onclick="irPara('inicio')">Voltar</button>
</div>

<!-- Tela que mostra os dados da reserva encontrada -->
<div id="dadosReserva" class="container">
    <h2>Minha Reserva</h2>
    <p id="infoReserva"></p> <!-- aqui serão exibidos os detalhes -->

    <!-- Botões que aparecem somente quando uma reserva é encontrada -->
    <button id="btnEditar" onclick="abrirEdicao()" style="display:none;">Editar Reserva</button>
    <button id="btnCancelar" onclick="cancelarReserva()" style="display:none;">Cancelar Reserva</button>

    <button onclick="irPara('inicio')">Voltar</button> <!-- volta ao início -->
</div>

<!-- Tela para edição da reserva (trocar mesa/horário/nome) -->
<div id="editarReserva" class="container">
    <h2>Editar Reserva</h2>

    <input type="text" id="editNome" placeholder="Nome"><br> <!-- campo para editar o nome -->

    <!-- dropdown para escolher novo horário; onchange atualiza mapa de edição -->
    <select id="editHorario" onchange="mostrarMesasEdicao()">
        <option>10h às 11h</option>
        <option>11h às 12h</option>
        <option>12h às 13h</option>
        <option>13h às 14h</option>
        <option>14h às 15h</option>
    </select>

    <!-- mapa para edição (mesas clicáveis) -->
    <div id="mapaMesasEdicao"></div>

    <button onclick="salvarEdicao()">Salvar Alterações</button> <!-- salva alterações -->
    <button onclick="irPara('dadosReserva')">Cancelar</button> <!-- volta para dados sem salvar -->
</div>

<!-- ============================================================
     ===================== JAVASCRIPT ============================
     ============================================================ -->
<script>

// ---------------- Variáveis globais ----------------

// Array com os horários suportados — usado como referência em todo o sistema
const horarios = ["10h às 11h","11h às 12h","12h às 13h","13h às 14h","14h às 15h"];

// Objeto que guarda, para cada horário, um array de 12 booleanos (true = ocupada)
let mesasPorHorario = {};

// Array com objetos de reserva: cada objeto contém nome, email, senha, mesa, horário, código
let reservas = [];

// Variáveis que armazenam temporariamente escolhas durante o fluxo de reserva
let mesaEscolhida = null; // índice 0-based da mesa selecionada para nova reserva
let horarioEscolhido = null; // string do horário selecionado para nova reserva

// Referência para a reserva atual (usada quando cliente consulta e edita/cancela)
let reservaAtual = null;

// Variável para edição: índice 0-based da mesa escolhida durante a edição
let selectedMesaEdit = null;

// ---------------- Carregar do LocalStorage ----------------

// Função que carrega dados persistidos (se houver) no localStorage do navegador
function carregarDados() {
    // tenta parsear o JSON salvo em 'mesasPorHorario'; se nulo, retorna {}
    mesasPorHorario = JSON.parse(localStorage.getItem("mesasPorHorario")) || {};
    // tenta parsear o JSON salvo em 'reservas'; se nulo, retorna []
    reservas = JSON.parse(localStorage.getItem("reservas")) || [];

    // garante que para cada horário exista um array de 12 mesas (inicializa se não existir)
    horarios.forEach(h => {
        if (!mesasPorHorario[h]) mesasPorHorario[h] = Array(12).fill(false);
    });
}
// Carrega dados assim que o script é executado
carregarDados();

// Função que salva o estado atual em localStorage (persistência simples)
function salvarDados() {
    localStorage.setItem("mesasPorHorario", JSON.stringify(mesasPorHorario));
    localStorage.setItem("reservas", JSON.stringify(reservas));
}

// ---------------- Navegação SPA ----------------

// Função para trocar de "tela" em SPA: esconde todas e mostra a solicitada
function irPara(tela) {
    // esconde todas as divs .container
    document.querySelectorAll('.container').forEach(t => t.style.display = "none");
    // mostra a tela desejada definindo display:flex
    document.getElementById(tela).style.display = "flex";

    // quando entra na tela 'mapa', esconde o botão reservar e atualiza o mapa
    if (tela === "mapa") {
        document.getElementById("btnReservar").style.display = "none";
        mostrarMesas(); // desenha as mesas conforme o horário selecionado
    }

    // quando vai para a tela que mostra dados da reserva, atualiza visibilidade dos botões
    if (tela === "dadosReserva") {
        document.getElementById("btnEditar").style.display = reservaAtual ? "inline-block" : "none";
        document.getElementById("btnCancelar").style.display = reservaAtual ? "inline-block" : "none";
    }
}

// ---------------- Mostrar Mesas (nova reserva) ----------------

// Função que monta dinamicamente as divs das mesas dentro do mapa
function mostrarMesas() {
    // recupera o horário selecionado no select com id 'horario'
    const horario = document.getElementById("horario").value;
    // obtém a div onde as mesas serão inseridas
    const div = document.getElementById("mapaMesas");
    // limpa o conteúdo atual (remove mesas antigas)
    div.innerHTML = "";
    // guarda o horário escolhido globalmente
    horarioEscolhido = horario;

    // posições percentuais (left / top) para posicionar cada mesa no mapa
    const pos = [
        {x: 13, y: 12.3},{x: 26.2, y: 12.3},{x: 39.4, y: 12.3},
        {x: 64.5, y: 12.3},{x: 77.7, y: 12.3},{x: 90, y: 12.3},

        {x: 13, y: 52.5},{x: 26.2, y: 52.5},{x: 39.4, y: 52.5},
        {x: 63.6, y: 52.5},{x: 76.8, y: 52.5},{x: 90, y: 52.5},
    ];

    // percorre o array de booleanos para o horário e cria cada div de mesa
    mesasPorHorario[horario].forEach((ocupada, i) => {
        const mesa = document.createElement("div"); // cria a div da mesa
        mesa.className = "mesa " + (ocupada ? "ocupada" : "disponivel"); // aplica classe
        mesa.innerText = i + 1; // exibe número humano da mesa (1-based)
        mesa.style.left = pos[i].x + "%"; // posiciona horizontal em %
        mesa.style.top = pos[i].y + "%"; // posiciona vertical em %

        // se não estiver ocupada, permite clicar para selecionar (somente mesas livres)
        if (!ocupada) mesa.onclick = () => selecionarMesa(i);

        // adiciona a mesa ao container do mapa
        div.appendChild(mesa);
    });
}

// ---------------- Selecionar Mesa ----------------

// Função chamada quando o usuário clica em uma mesa livre no mapa
function selecionarMesa(i) {
    mesaEscolhida = i; // armazena a mesa selecionada (índice 0-based)

    // remove destaque (borda) de todas as mesas para limpar estado visual
    document.querySelectorAll("#mapaMesas .mesa").forEach(m => {
        m.style.border = "2px solid rgba(255,255,255,0.3)";
    });

    // seleciona todas as mesas e aplica borda dourada na escolhida
    const mesas = document.querySelectorAll("#mapaMesas .mesa");
    mesas[i].style.border = "3px solid #d4af37";

    // exibe o botão para prosseguir com o cadastro/reserva
    document.getElementById("btnReservar").style.display = "inline-block";
}

// ---------------- Finalizar Reserva ----------------

// Função que valida dados do formulário e cria uma nova reserva
function finalizarReserva() {
    // pega valores dos inputs do formulário
    const nome = document.getElementById("nome").value.trim();
    const emailRaw = document.getElementById("email").value.trim();
    const senha = document.getElementById("senha").value.trim();

    // validação simples: todos os campos obrigatórios
    if (!nome || !emailRaw || !senha) return alert("Preencha todos os campos!");

    // normaliza email para facilitar comparações
    const email = emailRaw.toLowerCase();

    // impede múltiplas reservas com o mesmo email
    if (reservas.some(r => r.email === email))
        return alert("Já existe uma reserva com este email!");

    // gera um código único simples para a reserva
    const codigo = "GT-" + Math.floor(100000 + Math.random()*900000);

    // marca a mesa como ocupada no horário escolhido
    mesasPorHorario[horarioEscolhido][mesaEscolhida] = true;

    // adiciona objeto de reserva ao array de reservas
    reservas.push({
        nome, // nome do cliente
        email, // email normalizado
        emailRaw, // email no formato original (para exibição)
        senha, // senha escolhida pelo cliente (simples)
        mesa: mesaEscolhida + 1, // armazena mesa em formato humano (1-based)
        horario: horarioEscolhido, // horário escolhido
        codigo // código gerado
    });

    // persiste no localStorage
    salvarDados();

    // monta e exibe mensagem de confirmação com dados importantes
    document.getElementById("msgAgradecimento").innerHTML =
        `Obrigado, <b>${nome}</b>!<br>
         Mesa: <b>${mesaEscolhida+1}</b><br>
         Horário: <b>${horarioEscolhido}</b><br>
         Código: <b>${codigo}</b>`;

    // navega para a tela de agradecimento
    irPara("agradecimento");
}

// ---------------- Consulta de Reserva (cliente) ----------------

// Função que busca uma reserva com base em email e senha (inputs de consulta)
function consultarReserva() {
    // captura email e senha dos inputs de consulta
    const email = document.getElementById("emailLogin").value.trim().toLowerCase();
    const senha = document.getElementById("senhaLogin").value.trim();

    // procura no array de reservas uma que bata com email e senha
    const r = reservas.find(x => x.email === email && x.senha === senha);

    // se não encontrado, avisa o usuário
    if (!r) return alert("Reserva não encontrada!");

    // atribui a reserva encontrada à variável global reservaAtual
    reservaAtual = r;

    // exibe as informações da reserva no elemento infoReserva
    document.getElementById("infoReserva").innerHTML =
        `Nome: <b>${r.nome}</b><br>
         Email: <b>${r.emailRaw}</b><br>
         Mesa: <b>${r.mesa}</b><br>
         Horário: <b>${r.horario}</b><br>
         Código: <b>${r.codigo}</b>`;

    // navega para a tela que mostra os dados da reserva
    irPara("dadosReserva");
}

// ---------------- ADMIN LOGIN ----------------

// Função simples que valida credenciais administrativas (fixas)
function loginAdmin() {
    const u = document.getElementById("admUser").value.trim(); // usuário digitado
    const p = document.getElementById("admPass").value.trim(); // senha digitada

    // se usuário e senha conferem (adm / 0000) direciona para painel admin
    if (u === "adm" && p === "0000") {
        irPara("adminPainel");
    } else {
        alert("Credenciais inválidas!"); // avisa em caso de erro
    }
}

// ---------------- LISTAR RESERVAS DO ADMIN ----------------

// Função chamada quando o admin escolhe um horário no dropdown
function listarReservasHorario() {
    const horario = document.getElementById("adminHorarios").value; // horário escolhido
    const div = document.getElementById("listaAdmin"); // div onde será exibida a lista

    // filtra reservas que tenham o horário selecionado
    const lista = reservas.filter(r => r.horario === horario);

    // se não houver nenhuma, exibe uma mensagem informativa
    if (lista.length === 0) {
        div.innerHTML = "<br><b>Nenhuma reserva neste horário.</b>";
        return;
    }

    // monta HTML simples listando nome, mesa e código de cada reserva
    let html = "<br>";
    lista.forEach(r => {
        html += `• <b>${r.nome}</b> — Mesa <b>${r.mesa}</b> — Código: <b>${r.codigo}</b><br>`;
    });

    // injeta o HTML montado na div do admin
    div.innerHTML = html;
}

// ---------------- Abrir edição (cliente) ----------------

// Prepara a tela de edição com os dados da reserva atual
function abrirEdicao() {
    document.getElementById("editNome").value = reservaAtual.nome; // preenche nome
    document.getElementById("editHorario").value = reservaAtual.horario; // define horário selecionado

    selectedMesaEdit = reservaAtual.mesa - 1; // define mesa atual como selecionada (0-based)

    mostrarMesasEdicao(); // desenha o mapa de edição destacando a mesa atual
    irPara("editarReserva"); // vai para tela de edição
}

// ---------------- Mostrar mesas na edição ----------------

// Gera as mesas no mapa de edição, bloqueando as ocupadas (exceto a própria reserva)
function mostrarMesasEdicao() {
    const horario = document.getElementById("editHorario").value; // horário selecionado na edição
    const div = document.getElementById("mapaMesasEdicao"); // container de edição
    div.innerHTML = ""; // limpa conteudo anterior

    // mesmas posições percentuais do mapa principal
    const pos = [
        {x: 13, y: 12.3},{x: 26.2, y: 12.3},{x: 39.4, y: 12.3},
        {x: 64.5, y: 12.3},{x: 77.7, y: 12.3},{x: 90, y: 12.3},
        {x: 13, y: 52.5},{x: 26.2, y: 52.5},{x: 39.4, y: 52.5},
        {x: 63.6, y: 52.5},{x: 76.8, y: 52.5},{x: 90, y: 52.5},
    ];

    // percorre o status de ocupação das mesas no horário escolhido
    mesasPorHorario[horario].forEach((ocupada, i) => {
        // verifica se esta mesa é a própria mesa da reserva atual (permitir mantê-la)
        const own = (reservaAtual.horario === horario && reservaAtual.mesa - 1 === i);
        // considera "bloqueada" quando ocupada e não for a mesa da própria reserva
        const bloqueada = ocupada && !own;

        // cria o elemento visual da mesa
        const mesa = document.createElement("div");
        mesa.className = "mesa " + (bloqueada ? "ocupada" : "disponivel");
        mesa.innerText = i + 1;

        // posições (left / top) em porcentagem
        mesa.style.left = pos[i].x + "%";
        mesa.style.top = pos[i].y + "%";

        // se não estiver bloqueada, adiciona evento de clique para selecionar a mesa na edição
        if (!bloqueada) {
            mesa.onclick = () => {
                // limpa bordas de todas as mesas do mapa de edição
                document.querySelectorAll("#mapaMesasEdicao .mesa")
                    .forEach(m => m.style.border = "2px solid rgba(255,255,255,0.3)");
                mesa.style.border = "3px solid #d4af37"; // destaque dourado
                selectedMesaEdit = i; // salva a seleção 0-based
            };
        }

        // se a mesa é a atualmente selecionada no fluxo de edição, aplica o destaque inicial
        if (selectedMesaEdit === i && !bloqueada) {
            mesa.style.border = "3px solid #d4af37";
        }

        // adiciona a mesa ao mapa de edição
        div.appendChild(mesa);
    });
}

// ---------------- Salvar edição ----------------

// Salva as alterações feitas na reserva atual (nome, horário, mesa)
function salvarEdicao() {
    const novoNome = document.getElementById("editNome").value.trim(); // novo nome informado
    const novoHorario = document.getElementById("editHorario").value; // novo horário selecionado

    // guarda referências para liberar a mesa antiga
    const antigoHorario = reservaAtual.horario;
    const antigaMesa = reservaAtual.mesa - 1;

    // libera a mesa antiga (marca como false = livre)
    mesasPorHorario[antigoHorario][antigaMesa] = false;
    // marca a nova mesa no novo horário como ocupada
    mesasPorHorario[novoHorario][selectedMesaEdit] = true;

    // atualiza os dados da reserva atual (objeto referenciado já dentro do array 'reservas')
    reservaAtual.nome = novoNome;
    reservaAtual.horario = novoHorario;
    reservaAtual.mesa = selectedMesaEdit + 1; // grava em 1-based

    // salva alterações no localStorage
    salvarDados();

    // notifica o usuário e retorna para a tela inicial
    alert("Reserva alterada com sucesso!");
    irPara("inicio");
}

// ---------------- Cancelar reserva ----------------

// Remove a reserva atual e libera a mesa correspondente
function cancelarReserva() {
    const h = reservaAtual.horario; // horário da reserva a ser cancelada
    const m = reservaAtual.mesa - 1; // índice 0-based da mesa

    // marca a mesa como livre no horário
    mesasPorHorario[h][m] = false;
    // remove a reserva do array filtrando pelo código
    reservas = reservas.filter(r => r.codigo !== reservaAtual.codigo);

    // salva alterações no localStorage
    salvarDados();

    // notifica e retorna ao início
    alert("Reserva cancelada!");
    irPara("inicio");
}

// ---------------- Inicialização ----------------

// inicia a aplicação mostrando a tela inicial
irPara("inicio");

</script>

</body>
</html>
